<div class="dashboard-container">
  <div class="page-header">
    <h1 class="page-title">
      <mat-icon>dashboard</mat-icon>
      Dashboard
    </h1>
    <p class="page-subtitle">Overview of your attendance and work hours</p>
  </div>

  <!-- Today's Status Card -->
  <div class="today-card-wrapper">
    <attendance-actions></attendance-actions>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card stat-primary">
      <div class="stat-content">
        <div class="stat-icon-wrapper">
          <mat-icon class="stat-icon">calendar_today</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-label">Present Days</div>
          <div class="stat-value">{{ summary().totalPresentDays }}</div>
          <div class="stat-subtext">This month</div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card stat-success">
      <div class="stat-content">
        <div class="stat-icon-wrapper">
          <mat-icon class="stat-icon">schedule</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-label">Average Daily</div>
          <div class="stat-value">{{ (summary().averageDailyHours | number:'1.1-1') }}h</div>
          <div class="stat-subtext">Per day</div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card cumulative-status" [class.stat-warning]="getCumulativeStatus().aheadBehindMs < 0" [class.stat-success]="getCumulativeStatus().aheadBehindMs >= 0">
      <div class="stat-content">
        <div class="stat-icon-wrapper">
          <mat-icon class="stat-icon">
            {{ getStatusIcon(getCumulativeStatus().aheadBehindMs) }}
          </mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-label">{{ sign(getCumulativeStatus().aheadBehindMs) }} (Cumulative)</div>
          <div class="stat-value">
            {{ format(abs(getCumulativeStatus().aheadBehindMs)) }}
          </div>
          <div class="stat-subtext">
            {{ getCumulativeStatus().workingDaysElapsed }} working day{{ getCumulativeStatus().workingDaysElapsed !== 1 ? 's' : '' }} elapsed
          </div>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card stat-info">
      <div class="stat-content">
        <div class="stat-icon-wrapper">
          <mat-icon class="stat-icon">hourglass_empty</mat-icon>
        </div>
        <div class="stat-info">
          <div class="stat-label">Absent Days</div>
          <div class="stat-value">{{ summary().totalAbsentDaysMonth }}</div>
          <div class="stat-subtext">This month</div>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Charts Section -->
  <div class="charts-grid">
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>bar_chart</mat-icon>
          Weekly Overview
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas baseChart 
            [data]="weeklyChartData" 
            [options]="weeklyChartOptions"
            type="bar">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>show_chart</mat-icon>
          Current Month Trend
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas baseChart 
            [data]="monthlyChartData" 
            [options]="monthlyChartOptions"
            type="line">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Monthly Summary -->
  <mat-card class="summary-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>assessment</mat-icon>
        Monthly Summary
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="summary-section">
        <h3 class="section-title">Cumulative Status (Till Now)</h3>
        <div class="summary-grid">
          <div class="summary-item">
            <div class="summary-label">Total Worked</div>
            <div class="summary-value">{{ format(summary().month.totalMs) }}</div>
          </div>
          <div class="summary-item">
            <div class="summary-label">Target ({{ getCumulativeStatus().workingDaysElapsed }} days)</div>
            <div class="summary-value">{{ format(getCumulativeStatus().cumulativeTargetMs) }}</div>
          </div>
          <div class="summary-item highlight cumulative-highlight" [class.good]="getCumulativeStatus().aheadBehindMs >= 0" [class.bad]="getCumulativeStatus().aheadBehindMs < 0">
            <div class="summary-label">
              <mat-icon>{{ getStatusIcon(getCumulativeStatus().aheadBehindMs) }}</mat-icon>
              {{ sign(getCumulativeStatus().aheadBehindMs) }}
            </div>
            <div class="summary-value">{{ format(abs(getCumulativeStatus().aheadBehindMs)) }}</div>
            <div class="summary-hint">Based on {{ getCumulativeStatus().workingDaysElapsed }} working day{{ getCumulativeStatus().workingDaysElapsed !== 1 ? 's' : '' }} elapsed</div>
          </div>
        </div>
      </div>
      
      <div class="summary-section">
        <h3 class="section-title">Full Month Projection</h3>
        <div class="summary-grid">
          <div class="summary-item">
            <div class="summary-label">Monthly Target</div>
            <div class="summary-value">{{ format(summary().month.targetMs) }}</div>
          </div>
          <div class="summary-item">
            <div class="summary-label">Worked So Far</div>
            <div class="summary-value">{{ format(summary().month.totalMs) }}</div>
          </div>
          <div class="summary-item highlight">
            <div class="summary-label">
              <mat-icon>hourglass_empty</mat-icon>
              Remaining Hours Needed
            </div>
            <div class="summary-value" [class.remaining-positive]="getRemainingHours() > 0" [class.remaining-zero]="getRemainingHours() === 0">
              {{ format(getRemainingHours()) }}
            </div>
            <div class="summary-hint" *ngIf="getRemainingHours() > 0">
              {{ getRemainingDays() }} working day{{ getRemainingDays() !== 1 ? 's' : '' }} remaining
            </div>
            <div class="summary-hint" *ngIf="getRemainingHours() <= 0">
              Target achieved! ðŸŽ‰
            </div>
          </div>
          <div class="summary-item highlight">
            <div class="summary-label">
              <mat-icon>schedule</mat-icon>
              Average Daily Hours Needed
            </div>
            <div class="summary-value" [class.avg-hours-positive]="getAverageDailyHoursNeeded() > 0" [class.avg-hours-zero]="getAverageDailyHoursNeeded() === 0">
              {{ formatAverageDailyHours() }}
            </div>
            <div class="summary-hint" *ngIf="getAverageDailyHoursNeeded() > 0">
              Per day for remaining {{ getRemainingDays() }} working day{{ getRemainingDays() !== 1 ? 's' : '' }}
            </div>
            <div class="summary-hint" *ngIf="getAverageDailyHoursNeeded() === 0">
              Target already achieved! ðŸŽ‰
            </div>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Attendance Summary with Yearly and Monthly Absents -->
  <attendance-summary></attendance-summary>
</div>

